<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-1.11.1.js"></script>
<style>
    *{
        font-family: sans-serif;
    }
</style>



<script>




    function onSend(){
        const messageToSend = document.getElementById('messageToSend').value;
        document.getElementById('messageToSend').value = '';
        console.log(messageToSend)
    }
</script>








<script>
    let moments = [];
    let messages = [];
    function onLoad() {
        //$.get("http://a7b61c0e.ngrok.io/moments", function(data, status){
        $.get("http://localhost:3000/moments", function(data, status){
            moments = data.moments;
            
            
            const momentsHtml = moments.map(moment => {
                return `<div>
                    <button onclick='onLoadMessages("${moment._id}")'>
                        ${moment.name}
                    </button>
                    </div>`
            }).join('');
            document.getElementById('moments').innerHTML = momentsHtml
        });
    }
    function onLoadMessages (id){
        //$.get(`http://a7b61c0e.ngrok.io/messages/${id}`, function(data, status){
        $.get(`http://localhost:3000/messages/${id}`, function(data, status){
            messages = data.messages;
            
            const messagesHtml = messages.map(message => {
                return `<div>
                    <h4'>
                        ${message.user}
                    </h4>
                        ${message.message}
                    </div>`
            }).join('');
            document.getElementById('momentId').innerHTML = id
            document.getElementById('chat').innerHTML = messagesHtml
        });
    }
</script>


<h2>
    All moments
    <button onclick='onLoad()'>LOAD</button>
</h2>
<ul id='moments'>

</ul>

<h2>
    Current moment/chat 
    (<span id='momentId'></span>)
</h2>

<div id='chat'>

    
</div>
<input id='messageToSend' type="text">
<button onclick='onSend()'>SEND</button>